# Unequal Variance Discrimination vs Detection

Experiment comparing detection and discrimination with unequal variance, following up on an imaging experiment.
Run at the Wellcome Centre for Human Neuroimaging, UCL

To run the experiment:

1. Load 'experiment\data\subjects.mat'. This is a dictionary with paricipant identifiers as keys and numeral values. A value of 1 means higher confidence is mapped to bigger circles. A value of 2 means lower confidence is mapped to bigger circles.
2. Add a participant identifier that starts with a 3-digit number. For example, to add the participant '001KaFr', and to map high confidence to big circles, type in `subjects('001KaFr')=1`.
3. Save the ammended subject list (`save('experiment\data\subjects.mat','subjects')`).
4. Run the _openEndedCalibration.m_ function from within the experiment directory. In the user input box, type in the participant identifier you added to the subjects list. This function will calibrate transparency for each of the three tasks to reach around 70% accuracy.
5. Now _main.m_ can be run. To practice discrimination, detection, or tilt recognition, type '10','11', or '12' in the _practice_ field. Otherwise, type '0'.

Our analysis is written in Matlab, using SPM12. Our pre-registration document can be found in our [time-locked protocol folder](https://github.com/matanmazor/unequalVarianceDiscrimination/tree/main/experiment/protocolFolder/protocolFolder) (hash: 7c2c27da12b6768b1789907ba5d2ec46b45d302199d5368795879fcff844d043). To reproduce our analysis, do the following:

1. Clone this repository.
2. The behavioural analysis can be run from [analysis\Behaviour.mlx](https://github.com/matanmazor/unequalVarianceDiscrimination/blob/main/analysis/Behaviour.mlx).
3. Download the anonymized imaging dataset from openNeuro (dataset identifier: [ds004081](openneuro.org/datasets/ds004081)).
4. Imaging data were preprocessed as described in the paper, and using the [MetaLab core scripts](https://github.com/matanmazor/MetaLabCore). These scripts take as input the data in the raw format, as obtained from the scanner. For our ROI-based analyses, we provide ROI-specific summary statistics for each subject in data/ROI_data.
a. The Quadratic-Confidence Design Matrix can be generated by running tsv2DM1ConcatenatedRuns.m.
b. The Categorical-Confidence Design Matrices can be generated by running tsv2DM10ConcatenatedRuns.m, tsv2DM11ConcatenatedRuns.m, and tsv2DM12ConcatenatedRuns.m. Physiological recordings are available in this directory in data/physioDataFromPenta.
These design matrices can then be used to specify the model in SPM, using the function [modelSpecEst](https://github.com/matanmazor/MetaLabCore/blob/master/Stats/modelSpecEst.m).
6. Visualization and analysis of coefficients from the categorical design matrix is done using the extractManyROICongByResp3DMs.m, printConfByResp.m, and plotQuadFit.m functions.
7. Regions of Interest can be found in the analysis/ROIs subdirectory, in both standard and subject-native spaces.
8. To run the RSA analysis:
a. generate the appropriate design matrices using the function tsv2DM2.m.
b. Specify and estimate the model using the function [modelSpecEst4SL.m](https://github.com/matanmazor/MetaLabCore/blob/master/Stats/modelSpecEst4SL.m)
c. run [RSA.mlx]((https://github.com/matanmazor/unequalVarianceDiscrimination/blob/main/analysis/runRSA.mlx)
9. To run the multiple regression analysis on RDMs, run [multipleRegression.mlx]((https://github.com/matanmazor/unequalVarianceDiscrimination/blob/main/analysis/multipleRegression.mlx)
